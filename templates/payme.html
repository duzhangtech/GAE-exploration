
<!DOCTYPE html>
<html lang="en">
<head>
    <link href='http://fonts.googleapis.com/css?family=Josefin+Sans:600|Nunito' rel='stylesheet' type='text/css'>
    <link type="text/css" rel="stylesheet" href="/static/main.css" />
    <link type="text/css" rel="stylesheet" href="/static/animate.min.css" />
    <meta name = "viewport" content = "width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1">
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="/static/trademealpoints.js" type="text/javascript"></script>
    <script type="text/javascript" src="https://js.stripe.com/v2/"></script>
    
    <script>
    Stripe.setPublishableKey('pk_test_9tnZ37cNgvyDCfICwHjOctXm');
    var stripeResponseHandler = function(status, response) {
      var $form = $('#payment-form');
      if (response.error) {
        $form.find('.payment-errors').text(response.error.message);
        $form.find('button').prop('disabled', false);
      } else {
        var token = response.id; // token contains id, last4, and card type
        // Insert the token into the form so it gets submitted to the server
        $form.append($('<input type="hidden" name="stripeToken" />').val(token));
        $form.get(0).submit(); // and re-submit
      }
    };
    jQuery(function($) {
      $('#payment-form').submit(function(e) {
        var $form = $(this);
        $form.find('button').prop('disabled', true); // Disable the submit button to prevent repeated clicks
        Stripe.card.createToken($form, stripeResponseHandler);
        return false; // Prevent the form from submitting with the default action
      });
    });
    </script>
    
    <title>Get Meal Karma</title>
    
</head>
    
<body>

<a href = "/getkarma" id = "coffeeme" class = "animated fadeIn">Buy me a coffee</a>

<form action="" method="POST" id="payment-form" class = 'coffee animated fadeIn'>

    <div>
        <img src = "/static/amount.png" id = "amountpic" class = "icon" width="30px">
        <input type="text" id = 'payamount' placeholder = "amount" name = 'amount'>
        
        <img src = "/static/email.png" id = "emailpic" width="30px">
        <input type="text" id = 'payemail' placeholder = "email" name = 'email'/>
    </div>
    
    <div>
        <img src = "/static/card.png" id = "cardpic" class = "icon" width="30px">
        <input type="text" placeholder = "card number" data-stripe="number"/>
        <img src = "/static/cvc.png" id = "cvcpic" wclass = "icon" width="30px">
        <input type="text" placeholder = "cvc" class = "narrowinput" size="4" data-stripe="cvc"/>
    </div>    
    
    <div>
        <img src = "/static/calendar.png" id = "expirepic" class = "icon" width="30px">
        <input type="text" placeholder = "expires mm" data-stripe="exp-month"/>
        <input type="text" placeholder = "yyyy" class = "narrowinput" data-stripe="exp-year"/>
    </div> 
    
    <button type="submit" class = "button spaceup">Caffeine me</button>
    <div class="payment-errors spaceup"></div> 
</form>
    
<div id = 'payme' class = "animated fadeInUp"><a href = "https://stripe.com" class = "lightlink" target="_blank">Stripe</a> 
    takes care of the encrypted transaction and sends you a receipt. 
    <br>Trade Meal Points doesn't keep any of your card information.</div>
</body>
</html>